2025-07-07 23:52:16,380 - INFO - Starting comprehensive webhook test - Log file: booking_test_logs\test_all_webhooks_20250707_235216.log
2025-07-07 23:52:16,381 - INFO - === REDUCED WEBHOOK TEST: ONLY FAILING TESTS ===
2025-07-07 23:52:16,381 - INFO - Webhook API: http://localhost:8000
2025-07-07 23:52:16,382 - INFO - Test phone number: 0478621276
2025-07-07 23:52:16,382 - INFO - 
--- Testing find_next_available_any_practitioner ---
2025-07-07 23:52:16,382 - INFO - Endpoint: /find-next-available
2025-07-07 23:52:16,383 - INFO - Payload: {
  "sessionId": "test_comprehensive_123",
  "dialedNumber": "0478621276",
  "maxDays": 14,
  "service": "Massage",
  "locationId": "1717010852512540252",
  "locationName": "balmain"
}
2025-07-07 23:52:33,555 - INFO - Status: 200
2025-07-07 23:52:33,555 - INFO - Response: {"success":true,"found":true,"message":"Brendan Smith's next availability for Massage is Tuesday, July 08 at 9:00 AM at Location 2 and Tuesday, July 08 at 10:00 AM at Location 2.","slots":["Tuesday, July 08 at 9:00 AM at Location 2","Tuesday, July 08 at 10:00 AM at Location 2"],"sessionId":"test_comprehensive_123"}
2025-07-07 23:52:33,556 - INFO - SUCCESS: find_next_available_any_practitioner
2025-07-07 23:52:33,556 - INFO - 
--- Testing appointment_handler_book ---
2025-07-07 23:52:33,557 - INFO - Endpoint: /appointment-handler
2025-07-07 23:52:33,557 - INFO - Payload: {
  "patientName": "Test Patient Comprehensive",
  "patientPhone": "0412345678",
  "practitioner": "Brendan Smith",
  "appointmentType": "Massage",
  "appointmentDate": "2025-07-14",
  "appointmentTime": "14:00",
  "business_id": "1717010852512540252",
  "location": "balmain",
  "action": "book",
  "sessionId": "test_comprehensive_123",
  "dialedNumber": "0478621276"
}
2025-07-07 23:52:39,181 - INFO - Status: 200
2025-07-07 23:52:39,181 - INFO - Response: {"success":false,"error":"time_not_available","message":"I'm sorry, {display_time} is not available on {display_date}. Brendan Smith has these times available: 9:00 AM, 10:00 AM, 11:00 AM, 12:00 PM, 1:00 PM. Which time would you prefer?","sessionId":"test_comprehensive_123","availableTimes":["9:00 AM","10:00 AM","11:00 AM","12:00 PM","1:00 PM"]}
2025-07-07 23:52:39,182 - ERROR - FAILED: appointment_handler_book - I'm sorry, {display_time} is not available on {display_date}. Brendan Smith has these times available: 9:00 AM, 10:00 AM, 11:00 AM, 12:00 PM, 1:00 PM. Which time would you prefer?
2025-07-07 23:52:39,182 - INFO - 
==================================================
2025-07-07 23:52:39,182 - INFO - TEST SUMMARY
2025-07-07 23:52:39,183 - INFO - ==================================================
2025-07-07 23:52:39,183 - INFO - find_next_available_any_practitioner: PASS
2025-07-07 23:52:39,183 - INFO - appointment_handler_book: FAIL
2025-07-07 23:52:39,184 - INFO -   Error: I'm sorry, {display_time} is not available on {display_date}. Brendan Smith has these times available: 9:00 AM, 10:00 AM, 11:00 AM, 12:00 PM, 1:00 PM. Which time would you prefer?
2025-07-07 23:52:39,184 - INFO - 
Overall: 1/2 tests passed
2025-07-07 23:52:39,184 - INFO - 
1 tests failed
2025-07-07 23:52:39,185 - INFO - 
Detailed results saved to: booking_test_logs\test_all_webhooks_20250707_235216.log
