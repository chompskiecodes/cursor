2025-07-05 23:48:14,157 - INFO - Starting webhook booking test - Log file: booking_test_logs\booking_test_20250705_234814.log
2025-07-05 23:48:14,158 - INFO - === Webhook-First Booking Test ===
2025-07-05 23:48:14,158 - INFO - Webhook API: http://localhost:8000
2025-07-05 23:48:14,159 - INFO - Test phone number: 0478621276
2025-07-05 23:48:14,159 - INFO - 
--- Step 1: Check Availability via Webhook (date: 2025-07-06) ---
2025-07-05 23:48:14,159 - INFO - Payload: {
  "practitioner": "Brendan Smith",
  "appointmentType": "Massage",
  "date": "2025-07-06",
  "sessionId": "test_booking_123",
  "dialedNumber": "0478621276"
}
2025-07-05 23:48:26,762 - INFO - Status: 200
2025-07-05 23:48:26,763 - INFO - Response: {"success":true,"message":"Brendan Smith doesn't have any availability on Sunday, July 06, 2025 at any of their locations (balmain, City Clinic, Location 2).\nNext available days by location:\nbalmain: Monday, July 07, 2025\nCity Clinic: Wednesday, July 09, 2025\nLocation 2: Tuesday, July 08, 2025","sessionId":"test_booking_123"}
2025-07-05 23:48:26,763 - ERROR - No available slots returned.
2025-07-05 23:48:26,763 - INFO - 
--- Step 1: Check Availability via Webhook (date: 2025-07-07) ---
2025-07-05 23:48:26,764 - INFO - Payload: {
  "practitioner": "Brendan Smith",
  "appointmentType": "Massage",
  "date": "2025-07-07",
  "sessionId": "test_booking_123",
  "dialedNumber": "0478621276"
}
2025-07-05 23:48:29,398 - INFO - Status: 200
2025-07-05 23:48:29,399 - INFO - Response: {"success":true,"sessionId":"test_booking_123","message":"Brendan Smith has the following times available at balmain on Monday, July 07, 2025: 12:00 PM, 1:00 PM, 4:00 PM","error":null,"practitioner":{"id":"1702104296348198163","name":"Brendan Smith","firstName":"Brendan","servicesCount":0},"date":"Monday, July 07, 2025","slots":[{"date":"Monday, July 07, 2025","time":"12:00 PM","displayTime":"12:00 PM"},{"date":"Monday, July 07, 2025","time":"1:00 PM","displayTime":"1:00 PM"},{"date":"Monday, July 07, 2025","time":"4:00 PM","displayTime":"4:00 PM"}],"location":{"id":"1717010852512540252","name":"balmain"}}
2025-07-05 23:48:29,399 - INFO - 
--- Step 2: Book Appointment via Webhook ---
2025-07-05 23:48:29,400 - INFO - Booking payload: {
  "action": "book",
  "sessionId": "test_booking_123",
  "dialedNumber": "0478621276",
  "callerPhone": "0412345678",
  "patientName": "Test Patient",
  "patientPhone": "0412345678",
  "practitioner": "Brendan Smith",
  "appointmentType": "Massage",
  "appointmentDate": "2025-07-07",
  "appointmentTime": "12:00 PM",
  "locationId": "1717010852512540252",
  "location": "balmain"
}
2025-07-05 23:48:33,685 - INFO - Status: 200
2025-07-05 23:48:33,685 - INFO - Response: {"success":false,"error":"booking_failed","message":"I'm sorry, I encountered an error while booking your appointment. Please try again or contact the clinic directly.","sessionId":"test_booking_123"}
2025-07-05 23:48:33,692 - ERROR - Error details: booking_failed
2025-07-05 23:48:33,696 - ERROR - 
Check log file for details: booking_test_logs\booking_test_20250705_234814.log
