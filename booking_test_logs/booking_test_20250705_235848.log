2025-07-05 23:58:48,691 - INFO - Starting webhook booking test - Log file: booking_test_logs\booking_test_20250705_235848.log
2025-07-05 23:58:48,691 - INFO - === Webhook-First Booking Test ===
2025-07-05 23:58:48,692 - INFO - Webhook API: http://localhost:8000
2025-07-05 23:58:48,692 - INFO - Test phone number: 0478621276
2025-07-05 23:58:48,692 - INFO - 
--- Step 1: Check Availability via Webhook (date: 2025-07-06) ---
2025-07-05 23:58:48,693 - INFO - Payload: {
  "practitioner": "Brendan Smith",
  "appointmentType": "Massage",
  "date": "2025-07-06",
  "sessionId": "test_booking_123",
  "dialedNumber": "0478621276"
}
2025-07-05 23:58:51,799 - INFO - Status: 200
2025-07-05 23:58:51,799 - INFO - Response: {"success":true,"message":"Brendan Smith doesn't have any availability on Sunday, July 06, 2025 at any of their locations (balmain, City Clinic, Location 2).\nNext available days by location:\nbalmain: Monday, July 07, 2025\nCity Clinic: Wednesday, July 09, 2025\nLocation 2: Tuesday, July 08, 2025","sessionId":"test_booking_123"}
2025-07-05 23:58:51,800 - ERROR - No available slots returned.
2025-07-05 23:58:51,800 - INFO - 
--- Step 1: Check Availability via Webhook (date: 2025-07-07) ---
2025-07-05 23:58:51,801 - INFO - Payload: {
  "practitioner": "Brendan Smith",
  "appointmentType": "Massage",
  "date": "2025-07-07",
  "sessionId": "test_booking_123",
  "dialedNumber": "0478621276"
}
2025-07-05 23:58:54,438 - INFO - Status: 200
2025-07-05 23:58:54,439 - INFO - Response: {"success":true,"sessionId":"test_booking_123","message":"Brendan Smith has the following times available at balmain on Monday, July 07, 2025: 12:00 PM, 1:00 PM, 4:00 PM","error":null,"practitioner":{"id":"1702104296348198163","name":"Brendan Smith","firstName":"Brendan","servicesCount":0},"date":"Monday, July 07, 2025","slots":[{"date":"Monday, July 07, 2025","time":"12:00 PM","displayTime":"12:00 PM"},{"date":"Monday, July 07, 2025","time":"1:00 PM","displayTime":"1:00 PM"},{"date":"Monday, July 07, 2025","time":"4:00 PM","displayTime":"4:00 PM"}],"location":{"id":"1717010852512540252","name":"balmain"}}
2025-07-05 23:58:54,440 - INFO - 
--- Step 2: Book Appointment via Webhook ---
2025-07-05 23:58:54,440 - INFO - Booking payload: {
  "action": "book",
  "sessionId": "test_booking_123",
  "dialedNumber": "0478621276",
  "callerPhone": "0412345678",
  "patientName": "Test Patient",
  "patientPhone": "0412345678",
  "practitioner": "Brendan Smith",
  "appointmentType": "Massage",
  "appointmentDate": "2025-07-07",
  "appointmentTime": "12:00 PM",
  "locationId": "1717010852512540252",
  "location": "balmain"
}
2025-07-05 23:59:00,999 - INFO - Status: 200
2025-07-05 23:59:01,000 - INFO - Response: {"success":true,"message":"Perfect! I've successfully booked your Massage appointment with Brendan Smith for Monday, July 07, 2025 at 12:00 PM.","appointmentDetails":{"appointmentId":"1723214207828108400","practitioner":"Brendan Smith","service":"Massage","duration":"60 minutes","date":"Monday, July 07, 2025","time":"12:00 PM","location":"balmain","patient":"Test Patient"},"sessionId":"test_booking_123"}
2025-07-05 23:59:01,018 - INFO - Message: Perfect! I've successfully booked your Massage appointment with Brendan Smith for Monday, July 07, 2025 at 12:00 PM.
2025-07-05 23:59:01,018 - INFO - Appointment Details: {
  "appointmentId": "1723214207828108400",
  "practitioner": "Brendan Smith",
  "service": "Massage",
  "duration": "60 minutes",
  "date": "Monday, July 07, 2025",
  "time": "12:00 PM",
  "location": "balmain",
  "patient": "Test Patient"
}
2025-07-05 23:59:01,025 - INFO - 
Test results saved to: booking_test_logs\booking_test_20250705_235848.log
